<!DOCTYPE html>
<html>
<head>
  <title>Stations</title>

  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="https://maps.googleapis.com/maps/api/js"></script>
  <style>
    #map {
      width: 600px;
      height: 600px;
    }
  </style>  
</head>
<body>
  <div id="map"></div>
  <table id="logs">
    <tr><td>Name</td><td>Key</td><td>Location</td></tr>
  </table>
</body>

<script type="text/javascript">
  $(function(){ 
    var mapsOptions = {
      center: new google.maps.LatLng(48.856614,2.3522219),
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      zoom: 5
    };

    map = new google.maps.Map(document.getElementById("map"), mapsOptions);

    function setup_marker_info(marker){
      google.maps.event.addListener(marker, 'click', function() {
          var infowindow = new google.maps.InfoWindow({
            content: marker.title
          });
          infowindow.open(map, marker);
        });
    }

    $.ajax({
      type:'GET',
      url:'http://localhost:3000/metro/stations',
      success:function(result) {
        if (result['stations']) {
          result['stations'].forEach(function(station){
            if (station.lat && station.lng) {
              var latlng = new google.maps.LatLng(station.lat, station.lng);
              marker = new google.maps.Marker({
                position: latlng,
                map: map,
                title: station.name,
                icon: "http://maps.google.com/mapfiles/ms/icons/blue-dot.png"
              });

              setup_marker_info(marker);
            }
            else {
              $('#logs').append('<tr><td>' + station.name + '</td><td>' + station.key + '</td><td><a href="https://www.google.fr/maps/place/' + station.lat + ',' + station.lng + '" target="_blank">' + station.lat + 'x' + station.lng + '</a></td></tr>');
            }

          });
        }
      }
    });

  }); 
</script>
</html>